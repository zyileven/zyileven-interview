<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<div>
			Worker 输出内容：<span id="app"></span>
			<input type="text" title="" id="msg" />
			<button onclick="sendMessage()">发送</button>
			<button onclick="stopWorker()">stop!</button>
		</div>
		<script>
			if (typeof Worker === "undefined")
				// 使用Worker前检查一下浏览器是否支持
				document.writeln(" Sorry! No Web Worker support.. ");
			else {
				window.w = new Worker("workerThread1.js");
				window.w.onmessage = ev => { // 指定 worker 线程发消息时的回调
					document.getElementById("app").innerHTML = ev.data; // 将发送的内容附加在页面中
				};

				window.w.onerror = err => { // 指定 worker 线程发生错误时的回调
					window.w.terminate();
					console.log(error.filename, error.lineno, error.message); // 发生错误的文件名、行号、错误内容
				};

				function sendMessage() {
					const msg = document.getElementById("msg");
					window.w.postMessage(msg.value); // 主线程往 worker 线程发消息，消息可以是任意类型数据，包括二进制数据
				}

				function stopWorker() {
					window.w.terminate(); // 主线程关闭 worker 线程
				}
			}
		</script>
	</body>
</html>
